---
title: HTB-Cap
date: 18-08-2025 01:30:00
categories:
  - HTB
tags:
  - Enumeration
  - FTP
  - PrivEsc
  - setuid
  - gtfobins
---
Target - 10.129.150.71

To find open ports, do nmap -F {target}

![](https://cdn.vkie.pro/Pasted image 20250818235555.png)

As seen we noticed 3 open ports

lets enumerate FTP, lets try anonymous login

![](https://cdn.vkie.pro/Pasted image 20250818235826.png)

As per above Screenshot anonymous login not worked

So lets try port 80

![](https://cdn.vkie.pro/Pasted image 20250818235909.png)

lets explore the page we got, simultaneously run dirbuster for any other directories

![](https://cdn.vkie.pro/Pasted image 20250819000048.png)

capture directory throws 302, lets explore

![](https://cdn.vkie.pro/Pasted image 20250819000148.png)
download and explore the pcap file, 

either use wireshark or any open source pcap viewer sites
not much interesting things as of now
 
We got this, as u see above, the url reflects the pattern http://10.129.150.71/data/2
, /data/{id}

lets try all possible numbers, and explore the pcaps we got.

in /data/0 we got one pcap, with juicy infos

![](https://cdn.vkie.pro/Pasted image 20250819000438.png)

lets try this cred with ftp we saw previous

![](https://cdn.vkie.pro/Pasted image 20250819000646.png)

And yes we got login success.

now lets try SSH port, as seen in nmap results SSH 22 is open

![](https://cdn.vkie.pro/Pasted image 20250819000825.png)

and yes we can able to login, now lets enumerate

as we know users.txt will exist in user home directory, do ls and cat the file, and paste it to HTB

![](https://cdn.vkie.pro/Pasted image 20250819001300.png)

use linpeas to check any possiblities for privesc

in result we observed, python3 have capabilities, is found to have cap_setuid ad cap_bind_service.

go to gtfobins, and search python, under capabilities copy the code and paste

![](https://cdn.vkie.pro/Pasted image 20250819002513.png)

Thats it we are root now, 

![](https://cdn.vkie.pro/Pasted image 20250819002949.png)

Thanks for the time, see you in next post
